 
    <!DOCTYPE html> 
    <html lang="en"> 
    <head> 
        <meta charset="UTF-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
        <title>Decision Tree Visualization</title> 
        <style> 
            body { font-family: Arial, sans-serif; text-align: center}
            .tree-container { display: flex; justify-content: center; margin-top: 20px}
            .node { border: 2px solid blue; border-radius: 100%; background-color: lightcyan; color: lightcyan ;display: inline-block;  position: absolute; width: 24px; height: 24px} 
            .square { position: absolute; transform: translate(14px, 14px); z-index: -1}
            .leaf { display: inline-block; font-weight: bolder; position: absolute; line-height: 24px}
            .d_r:after { content: ""; width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: linear-gradient(to top right, transparent calc(50% - 1px), blue, transparent calc(50% + 1px))}
            .d_l:after { content: ""; width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: linear-gradient(to top left, transparent calc(50% - 1px), blue, transparent calc(50% + 1px))}
            .tooltip { position: absolute; background-color: rgba(0, 0, 0, 0.8); color: white; padding: 8px; border-radius: 5px; white-space: nowrap; visibility: hidden; opacity: 0; transition: opacity 0.3s; font-size: 14px; width: fit-content}
            .t_l { transform: translate(35px, -5px)}
            .t_r { transform: translateX(-100%) translate(-8px, -5px)}
            .leaf_value{ display: inline-block; font-weight: bolder; position: absolute; line-height: 24px; transform: translate(6px, 30px)}
            #legend { display: flex; flex-wrap: wrap; gap: 8px; position: absolute; bottom: 3%; width: 100%; justify-content: center; font-family: sans-serif}
            .legend-item { display: flex; align-items: center; gap: 6px; margin-right: 12px }
            .color-box { width: 16px; height: 16px; border: 1px solid #000; box-sizing: border-box}
        </style> 
    </head> 
    <body> 
        <h1>LBA_SLA</h1> 
        <div class="tree-container" id="tree"></div> 

        <div id="tooltip" class="tooltip"></div>
        
        <script> 
            const treeData = {
    "isLeaf": 0,
    "feature": "FVC",
    "distribution": "0=0.0, 1=0.17, 2=0.22, 3=0.29, 4A=0.01, 4B=0.3",
    "distArray": [
        0.004325883201153569,
        0.17231434751261715,
        0.2191780821917808,
        0.29343907714491707,
        0.014419610670511895,
        0.29632299927901945
    ],
    "lift1": "0=9.54, 1=1.96, 2=0.8, 3=0.44, 4A=13.48, 4B=0.41",
    "lift2": "0=5.15, 1=0.39, 2=0.56, 3=1.34, 4A=9.0, 4B=0.89",
    "treshold": ">80",
    "position": 1,
    "gpi": 0.08431073563625993,
    "ppi": 0.06473521087473362,
    "impurity": 0.7481282835933005,
    "labels": 1387,
    "labArray": [
        "0",
        "1",
        "2",
        "3",
        "4A",
        "4B"
    ],
    "children": [
        {
            "isLeaf": 0,
            "feature": "PUMNS_AAII",
            "distribution": "0=0.01, 1=0.31, 2=0.28, 3=0.31, 4A=0.0, 4B=0.09",
            "distArray": [
                0.008460236886632826,
                0.3062605752961083,
                0.28426395939086296,
                0.3079526226734349,
                0.00338409475465313,
                0.08967851099830795
            ],
            "lift1": "0=4.23, 1=1.43, 2=0.57, 3=0.55, 4A=28.56, 4B=1.1",
            "lift2": "0=5.11, 1=0.21, 2=0.69, 3=0.75, 4A=32.32, 4B=3.97",
            "treshold": "0, 1, 2, 3",
            "position": 2,
            "gpi": 0.0699904413598725,
            "ppi": 0.06480991193490289,
            "impurity": 0.7224383805589195,
            "labels": 591,
            "labArray": [
                "0",
                "1",
                "2",
                "3",
                "4A",
                "4B"
            ],
            "children": [
                {
                    "isLeaf": 0,
                    "feature": "terapia",
                    "distribution": "0=0.01, 1=0.36, 2=0.31, 3=0.23, 4A=0.0, 4B=0.09",
                    "distArray": [
                        0.010101010101010102,
                        0.35555555555555557,
                        0.3090909090909091,
                        0.23030303030303031,
                        0.00404040404040404,
                        0.09090909090909091
                    ],
                    "lift1": "0=4.36, 1=1.45, 2=0.42, 3=0.51, 4A=26.28, 4B=0.93",
                    "lift2": "0=6.18, 1=0.19, 2=0.87, 3=1.0, 4A=67.69, 4B=1.06",
                    "treshold": "Riluzolo, Riluzolo e Edaravone, nessuna terapia",
                    "position": 4,
                    "gpi": 0.03007383077958633,
                    "ppi": 0.01942718555837554,
                    "impurity": 0.7166207529843893,
                    "labels": 495,
                    "labArray": [
                        "0",
                        "1",
                        "2",
                        "3",
                        "4A",
                        "4B"
                    ],
                    "children": [
                        {
                            "isLeaf": 0,
                            "feature": "VENTILAZIONE",
                            "distribution": "0=0.01, 1=0.39, 2=0.29, 3=0.22, 4A=0.0, 4B=0.09",
                            "distArray": [
                                0.008869179600886918,
                                0.3858093126385809,
                                0.29490022172949004,
                                0.21507760532150777,
                                0.0022172949002217295,
                                0.09312638580931264
                            ],
                            "lift1": "0=7.37, 1=0.53, 2=0.86, 3=0.96, 4A=73.13, 4B=1.16",
                            "lift2": "0=4.1, 1=1.2, 2=0.44, 3=0.66, 4A=39.4, 4B=1.51",
                            "treshold": "1",
                            "position": 8,
                            "gpi": 0.07125644771387608,
                            "ppi": 0.05572946846766808,
                            "impurity": 0.7091705547170367,
                            "labels": 451,
                            "labArray": [
                                "0",
                                "1",
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "1=0.18, 2=0.18, 3=0.23, 4B=0.41",
                                    "distArray": [
                                        0.17777777777777778,
                                        0.17777777777777778,
                                        0.23333333333333334,
                                        0.4111111111111111
                                    ],
                                    "position": 16,
                                    "value": "4B",
                                    "impurity": 0.7133333333333334,
                                    "labels": 90,
                                    "labArray": [
                                        "1",
                                        "2",
                                        "3",
                                        "4B"
                                    ],
                                    "gcr": "1=1.03, 2=0.81, 3=0.8, 4B=1.39"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "0=0.01, 1=0.44, 2=0.32, 3=0.21, 4A=0.0, 4B=0.01",
                                    "distArray": [
                                        0.0110803324099723,
                                        0.4376731301939058,
                                        0.32409972299168976,
                                        0.21052631578947367,
                                        0.002770083102493075,
                                        0.013850415512465374
                                    ],
                                    "position": 17,
                                    "value": "1",
                                    "impurity": 0.6587579898865109,
                                    "labels": 361,
                                    "labArray": [
                                        "0",
                                        "1",
                                        "2",
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "0=2.56, 1=2.54, 2=1.48, 3=0.72, 4A=0.19, 4B=0.05"
                                }
                            ]
                        },
                        {
                            "isLeaf": 0,
                            "feature": "Esordio_clinico_c",
                            "distribution": "0=0.02, 1=0.05, 2=0.45, 3=0.39, 4A=0.02, 4B=0.07",
                            "distArray": [
                                0.022727272727272728,
                                0.045454545454545456,
                                0.45454545454545453,
                                0.38636363636363635,
                                0.022727272727272728,
                                0.06818181818181818
                            ],
                            "lift1": "0=2.8, 1=1.4, 2=0.8, 3=0.45, 4A=7.49, 4B=2.43",
                            "lift2": "0=1.9, 1=0.9, 2=0.26, 3=1.04, 4A=4.17, 4B=4.38",
                            "treshold": "spinale",
                            "position": 9,
                            "gpi": 0.10562603419746293,
                            "ppi": 0.10562603419746297,
                            "impurity": 0.6363636363636364,
                            "labels": 44,
                            "labArray": [
                                "0",
                                "1",
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "0=0.03, 1=0.05, 2=0.54, 3=0.38",
                                    "distArray": [
                                        0.02702702702702703,
                                        0.05405405405405406,
                                        0.5405405405405406,
                                        0.3783783783783784
                                    ],
                                    "position": 18,
                                    "value": "2",
                                    "impurity": 0.5609934258582907,
                                    "labels": 37,
                                    "labArray": [
                                        "0",
                                        "1",
                                        "2",
                                        "3"
                                    ],
                                    "gcr": "0=6.25, 1=0.31, 2=2.47, 3=1.29"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "3=0.43, 4A=0.14, 4B=0.43",
                                    "distArray": [
                                        0.42857142857142855,
                                        0.14285714285714285,
                                        0.42857142857142855
                                    ],
                                    "position": 19,
                                    "value": "3",
                                    "impurity": 0.6122448979591837,
                                    "labels": 7,
                                    "labArray": [
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "3=1.46, 4A=9.91, 4B=1.45"
                                }
                            ]
                        }
                    ]
                },
                {
                    "isLeaf": 0,
                    "feature": "VENTILAZIONE",
                    "distribution": "1=0.05, 2=0.16, 3=0.71, 4B=0.08",
                    "distArray": [
                        0.052083333333333336,
                        0.15625,
                        0.7083333333333334,
                        0.08333333333333333
                    ],
                    "lift1": "1=1.21, 2=2.24, 3=0.33, 4B=4.22",
                    "lift2": "1=1.0, 2=0.65, 3=0.28, 4B=7.76",
                    "treshold": "0, 2",
                    "position": 5,
                    "gpi": 0.161308969630615,
                    "ppi": 0.1527139954791654,
                    "impurity": 0.46419270833333326,
                    "labels": 96,
                    "labArray": [
                        "1",
                        "2",
                        "3",
                        "4B"
                    ],
                    "children": [
                        {
                            "isLeaf": 1,
                            "distribution": "1=0.06, 2=0.17, 3=0.77",
                            "distArray": [
                                0.060240963855421686,
                                0.1686746987951807,
                                0.7710843373493976
                            ],
                            "position": 10,
                            "value": "3",
                            "impurity": 0.37334881695456523,
                            "labels": 83,
                            "labArray": [
                                "1",
                                "2",
                                "3"
                            ],
                            "gcr": "1=0.35, 2=0.77, 3=2.63"
                        },
                        {
                            "isLeaf": 0,
                            "feature": "Tracheostomia",
                            "distribution": "2=0.08, 3=0.31, 4B=0.62",
                            "distArray": [
                                0.07692307692307693,
                                0.3076923076923077,
                                0.6153846153846154
                            ],
                            "lift1": "2=2.43, 3=2.36, 4B=0.14",
                            "lift2": "2=0.73, 3=0.32, 4B=1.38",
                            "treshold": "1",
                            "position": 11,
                            "gpi": 0.5157828282828285,
                            "ppi": 0.5157828282828284,
                            "impurity": 0.5207100591715975,
                            "labels": 13,
                            "labArray": [
                                "2",
                                "3",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "2=0.25, 3=0.75",
                                    "distArray": [
                                        0.25,
                                        0.75
                                    ],
                                    "position": 22,
                                    "value": "3",
                                    "impurity": 0.375,
                                    "labels": 4,
                                    "labArray": [
                                        "2",
                                        "3"
                                    ],
                                    "gcr": "2=1.14, 3=2.56"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "3=0.11, 4B=0.89",
                                    "distArray": [
                                        0.1111111111111111,
                                        0.8888888888888888
                                    ],
                                    "position": 23,
                                    "value": "4B",
                                    "impurity": 0.19753086419753085,
                                    "labels": 9,
                                    "labArray": [
                                        "3",
                                        "4B"
                                    ],
                                    "gcr": "3=0.38, 4B=3.0"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "isLeaf": 0,
            "feature": "VENTILAZIONE",
            "distribution": "0=0.0, 1=0.07, 2=0.17, 3=0.28, 4A=0.02, 4B=0.45",
            "distArray": [
                0.001256281407035176,
                0.0728643216080402,
                0.1708542713567839,
                0.28266331658291455,
                0.022613065326633167,
                0.44974874371859297
            ],
            "lift1": "0=20.89, 1=0.58, 2=1.15, 3=0.96, 4A=7.4, 4B=0.66",
            "lift2": "0=36.81, 1=3.33, 2=0.97, 3=0.73, 4A=8.32, 4B=0.33",
            "treshold": "1, 2, 3",
            "position": 3,
            "gpi": 0.3327525335725324,
            "ppi": 0.32472779310514227,
            "impurity": 0.6828141966111967,
            "labels": 796,
            "labArray": [
                "0",
                "1",
                "2",
                "3",
                "4A",
                "4B"
            ],
            "children": [
                {
                    "isLeaf": 0,
                    "feature": "MRC_Bulbare",
                    "distribution": "1=0.02, 2=0.05, 3=0.09, 4A=0.02, 4B=0.82",
                    "distArray": [
                        0.01647058823529412,
                        0.05176470588235294,
                        0.09176470588235294,
                        0.01647058823529412,
                        0.8235294117647058
                    ],
                    "lift1": "1=6.84, 2=2.7, 3=3.31, 4A=17.58, 4B=0.19",
                    "lift2": "1=8.64, 2=3.8, 3=2.01, 4A=18.87, 4B=0.2",
                    "treshold": "1",
                    "position": 6,
                    "gpi": 0.02815242323318909,
                    "ppi": 0.028152423233189134,
                    "impurity": 0.3101564013840833,
                    "labels": 425,
                    "labArray": [
                        "1",
                        "2",
                        "3",
                        "4A",
                        "4B"
                    ],
                    "children": [
                        {
                            "isLeaf": 0,
                            "feature": "VENTILAZIONE",
                            "distribution": "1=0.03, 2=0.06, 3=0.14, 4A=0.02, 4B=0.76",
                            "distArray": [
                                0.029914529914529916,
                                0.05555555555555555,
                                0.14102564102564102,
                                0.017094017094017096,
                                0.7564102564102564
                            ],
                            "lift1": "1=6.3, 2=2.35, 3=2.65, 4A=9.3, 4B=0.2",
                            "lift2": "1=3.98, 2=1.95, 3=2.08, 4A=18.17, 4B=0.22",
                            "treshold": "2",
                            "position": 12,
                            "gpi": 0.042904132336973766,
                            "ppi": 0.03729498828504454,
                            "impurity": 0.40368178829717294,
                            "labels": 234,
                            "labArray": [
                                "1",
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "1=0.33, 3=0.5, 4B=0.17",
                                    "distArray": [
                                        0.3333333333333333,
                                        0.5,
                                        0.16666666666666666
                                    ],
                                    "position": 24,
                                    "value": "3",
                                    "impurity": 0.611111111111111,
                                    "labels": 6,
                                    "labArray": [
                                        "1",
                                        "3",
                                        "4B"
                                    ],
                                    "gcr": "1=1.93, 3=1.7, 4B=0.56"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "1=0.02, 2=0.06, 3=0.13, 4A=0.02, 4B=0.77",
                                    "distArray": [
                                        0.021929824561403508,
                                        0.05701754385964912,
                                        0.13157894736842105,
                                        0.017543859649122806,
                                        0.7719298245614035
                                    ],
                                    "position": 25,
                                    "value": "4B",
                                    "impurity": 0.38277162203755,
                                    "labels": 228,
                                    "labArray": [
                                        "1",
                                        "2",
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "1=0.13, 2=0.26, 3=0.45, 4A=1.22, 4B=2.61"
                                }
                            ]
                        },
                        {
                            "isLeaf": 1,
                            "distribution": "2=0.05, 3=0.03, 4A=0.02, 4B=0.91",
                            "distArray": [
                                0.04712041884816754,
                                0.031413612565445025,
                                0.015706806282722512,
                                0.9057591623036649
                            ],
                            "position": 13,
                            "value": "4B",
                            "impurity": 0.17614648721252169,
                            "labels": 191,
                            "labArray": [
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "gcr": "2=0.21, 3=0.11, 4A=1.09, 4B=3.06"
                        }
                    ]
                },
                {
                    "isLeaf": 0,
                    "feature": "PUMNS_AASS",
                    "distribution": "0=0.0, 1=0.14, 2=0.31, 3=0.5, 4A=0.03, 4B=0.02",
                    "distArray": [
                        0.0026954177897574125,
                        0.13746630727762804,
                        0.30727762803234504,
                        0.5013477088948787,
                        0.029649595687331536,
                        0.0215633423180593
                    ],
                    "lift1": "0=8.39, 1=0.86, 2=1.18, 3=0.31, 4A=5.95, 4B=7.71",
                    "lift2": "0=9.48, 1=0.66, 2=0.34, 3=0.83, 4A=7.24, 4B=6.83",
                    "treshold": "0, 1, 2, 5",
                    "position": 7,
                    "gpi": 0.0915153747943193,
                    "ppi": 0.06413456348698698,
                    "impurity": 0.6339826069267152,
                    "labels": 371,
                    "labArray": [
                        "0",
                        "1",
                        "2",
                        "3",
                        "4A",
                        "4B"
                    ],
                    "children": [
                        {
                            "isLeaf": 0,
                            "feature": "PUMNS_Bulbare",
                            "distribution": "1=0.17, 2=0.4, 3=0.37, 4A=0.03, 4B=0.03",
                            "distArray": [
                                0.16740088105726872,
                                0.4008810572687225,
                                0.3744493392070485,
                                0.030837004405286344,
                                0.02643171806167401
                            ],
                            "lift1": "1=0.47, 2=1.32, 3=0.34, 4A=3.88, 4B=5.43",
                            "lift2": "1=2.03, 2=0.37, 3=0.4, 4A=4.52, 4B=8.33",
                            "treshold": "1, 3",
                            "position": 14,
                            "gpi": 0.04985022558227703,
                            "ppi": 0.02461303023139904,
                            "impurity": 0.6694094587513826,
                            "labels": 227,
                            "labArray": [
                                "1",
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "1=0.08, 2=0.5, 3=0.36, 4A=0.02, 4B=0.04",
                                    "distArray": [
                                        0.08181818181818182,
                                        0.5,
                                        0.36363636363636365,
                                        0.01818181818181818,
                                        0.03636363636363636
                                    ],
                                    "position": 28,
                                    "value": "2",
                                    "impurity": 0.6094214876033057,
                                    "labels": 110,
                                    "labArray": [
                                        "1",
                                        "2",
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "1=0.47, 2=2.28, 3=1.24, 4A=1.26, 4B=0.12"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "1=0.25, 2=0.31, 3=0.38, 4A=0.04, 4B=0.02",
                                    "distArray": [
                                        0.24786324786324787,
                                        0.3076923076923077,
                                        0.38461538461538464,
                                        0.042735042735042736,
                                        0.017094017094017096
                                    ],
                                    "position": 29,
                                    "value": "3",
                                    "impurity": 0.6938417707648478,
                                    "labels": 117,
                                    "labArray": [
                                        "1",
                                        "2",
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "1=1.44, 2=1.4, 3=1.31, 4A=2.96, 4B=0.06"
                                }
                            ]
                        },
                        {
                            "isLeaf": 0,
                            "feature": "PUMNS_AAII",
                            "distribution": "0=0.01, 1=0.09, 2=0.16, 3=0.7, 4A=0.03, 4B=0.01",
                            "distArray": [
                                0.006944444444444444,
                                0.09027777777777778,
                                0.1597222222222222,
                                0.7013888888888888,
                                0.027777777777777776,
                                0.013888888888888888
                            ],
                            "lift1": "0=5.06, 1=0.48, 2=1.73, 3=0.26, 4A=7.63, 4B=17.88",
                            "lift2": "0=2.72, 1=0.51, 2=0.8, 3=0.57, 4A=10.09, 4B=9.33",
                            "treshold": "2",
                            "position": 15,
                            "gpi": 0.10286596687317308,
                            "ppi": 0.03688742425853124,
                            "impurity": 0.47337962962962965,
                            "labels": 144,
                            "labArray": [
                                "0",
                                "1",
                                "2",
                                "3",
                                "4A",
                                "4B"
                            ],
                            "children": [
                                {
                                    "isLeaf": 1,
                                    "distribution": "2=0.67, 3=0.33",
                                    "distArray": [
                                        0.6666666666666666,
                                        0.3333333333333333
                                    ],
                                    "position": 30,
                                    "value": "2",
                                    "impurity": 0.4444444444444445,
                                    "labels": 6,
                                    "labArray": [
                                        "2",
                                        "3"
                                    ],
                                    "gcr": "2=3.04, 3=1.14"
                                },
                                {
                                    "isLeaf": 1,
                                    "distribution": "0=0.01, 1=0.09, 2=0.14, 3=0.72, 4A=0.03, 4B=0.01",
                                    "distArray": [
                                        0.007246376811594203,
                                        0.09420289855072464,
                                        0.13768115942028986,
                                        0.717391304347826,
                                        0.028985507246376812,
                                        0.014492753623188406
                                    ],
                                    "position": 31,
                                    "value": "3",
                                    "impurity": 0.4564167191766435,
                                    "labels": 138,
                                    "labArray": [
                                        "0",
                                        "1",
                                        "2",
                                        "3",
                                        "4A",
                                        "4B"
                                    ],
                                    "gcr": "0=1.68, 1=0.55, 2=0.63, 3=2.44, 4A=2.01, 4B=0.05"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}; 
            const plotData = {
    "l_c": 0.9375,
    "r_c": 0.9375,
    "depth": 4,
    "colors": [
        "#FF6384",
        "#36A2EB",
        "#FFCE56",
        "#4CAF50",
        "#9966FF",
        "#D81B60",
        "#00ACC1",
        "#8D6E63",
        "#FF9800"
    ],
    "labels": [
        "0",
        "1",
        "2",
        "3",
        "4A",
        "4B"
    ]
};
            
            function iter(node, top, left, d, h) {
                if(node.isLeaf == 1){
                    let nodeElement = document.createElement("div")
                    nodeElement.classList.add("leaf")
                    nodeElement.style.left = left + "%"
                    nodeElement.style.top = top + "%"

                    nodeElement.onmouseover = function(event) { showTooltip(event, node, top, left); };
                    nodeElement.onmouseout = hideTooltip;
                    
                    let nodeValue = document.createElement("div")
                    nodeValue.classList.add("leaf_value")
                    nodeValue.style.left = left + "%"
                    nodeValue.style.top = top + "%"
                    nodeValue.innerText = node.value

                    let canvas = document.createElement("canvas");
                    canvas.width = 36;
                    canvas.height = 36;
                    canvas.style.position = "absolute";
                    canvas.style.top = "-6px";
                    canvas.style.left = "-6px";
                    nodeElement.appendChild(canvas);

                    tree = document.getElementById("tree")
                    tree.appendChild(nodeElement)
                    tree.appendChild(nodeValue)

                    if (node.distribution) {
                        drawPieChart(canvas, node.distArray, node.labArray);
                    }
                    return
                }

                let nodeElement = document.createElement("div")
                nodeElement.classList.add("node")
                nodeElement.style.left = left + "%"
                nodeElement.style.top = top + "%"
                nodeElement.onmouseover = function(event) { showTooltip(event, node, top, left); };
                nodeElement.onmouseout = hideTooltip;

                let lbranchElement = document.createElement("div")
                lbranchElement.classList.add("square")
                lbranchElement.classList.add("d_l")
                lbranchElement.style.right = (100-left) + "%"
                lbranchElement.style.top = top + "%"
                lbranchElement.style.height = h + "%"
                lbranchElement.style.width = d/2 + "%"

                let rbranchElement = document.createElement("div")
                rbranchElement.classList.add("square")
                rbranchElement.classList.add("d_r")
                rbranchElement.style.left = left + "%"
                rbranchElement.style.top = top + "%"
                rbranchElement.style.height = h + "%"
                rbranchElement.style.width = d/2 + "%"

                let canvas = document.createElement("canvas");
                canvas.width = 36;
                canvas.height = 36;
                canvas.style.position = "absolute";
                canvas.style.top = "-6px";
                canvas.style.left = "-6px";
                nodeElement.appendChild(canvas);

                tree = document.getElementById("tree")
                tree.appendChild(nodeElement)
                tree.appendChild(lbranchElement)
                tree.appendChild(rbranchElement)

                if (node.distribution) {
                    drawPieChart(canvas, node.distArray, node.labArray);
                }

                iter(node.children[0], top+h, left-d/2, d/2, h)
                iter(node.children[1], top+h, left+d/2, d/2, h)
                return
            }

            // Legend
            const legendContainer = document.createElement('div');
            legendContainer.id = 'legend';

            for (let i = 0; i < plotData.labels.length; i++) {
                const item = document.createElement('div');
                item.className = 'legend-item';

                const colorBox = document.createElement('div');
                colorBox.className = 'color-box';
                colorBox.style.backgroundColor = plotData.colors[i];

                const label = document.createElement('span');
                label.textContent = plotData.labels[i];

                item.appendChild(colorBox);
                item.appendChild(label);
                legendContainer.appendChild(item);
            }
            document.body.appendChild(legendContainer);

            function drawPieChart(canvas, distArray, labArray) {
                let ctx = canvas.getContext("2d");
                let total = distArray.reduce((sum, val) => sum + val, 0);
                let startAngle = 0;

                distArray.forEach((value, index) => {
                    let sliceAngle = (value / total) * 2 * Math.PI;

                    ctx.beginPath();
                    ctx.moveTo(18, 18);
                    ctx.arc(18, 18, 16, startAngle, startAngle + sliceAngle);
                    ctx.closePath();
                    plotData.labels.forEach((valueLab, indexLab) => {
                        if(valueLab == labArray[index]) {
                            ctx.fillStyle = plotData.colors[indexLab % plotData.colors.length];
                        }
                    })
                    ctx.fill();

                    startAngle += sliceAngle;
                });

                ctx.beginPath();
                ctx.arc(18, 18, 17, 0, 2 * Math.PI);
                ctx.strokeStyle = "blue";
                ctx.lineWidth = 2;
                ctx.stroke();
            }

            function showTooltip(event, node, top, left) {
                tooltip = document.getElementById('tooltip')

                if(node.isLeaf == 1){
                    tooltip.innerText = "Id: " + node.position + "\nN: " + node.labels + "\nClass distribution: [" + node.distribution +  "]\nGCR: [" + node.gcr + "]\nImpurty: " + node.impurity.toFixed(3) + "\nPrediction: "+ node.value;
                } else {
                    if(node.lift1 && node.lift2) {
                        tooltip.innerText = "Id: " + node.position + "\nN: " + node.labels +  "\nClass distribution: [" + node.distribution + "]\nLIFT left: [" + node.lift1 + "]\nLIFT right: [" + node.lift2 + "]\nFeature: " + node.feature + "\nThreshold left: [" + node.treshold + "]\nGpi: " + node.gpi.toFixed(3) + "\nPpi: " + node.ppi.toFixed(3)  + "\nImpurty: " + node.impurity.toFixed(3);
                    } else {
                        tooltip.innerText = "Id: " + node.position + "\nN: " + node.labels +  "\nClass distribution: [" + node.distribution + "]\nFeature: " + node.feature + "\nThreshold left: [" + node.treshold + "]\nGpi: " + node.gpi.toFixed(3) + "\nPpi: " + node.ppi.toFixed(3)  + "\nImpurty: " + node.impurity.toFixed(3);
                    }
                }

                if(left > 50){
                    tooltip.style.left = left + "%"
                    tooltip.style.top = top + "%"
                    tooltip.classList.add("t_r")
                } else {
                    tooltip.style.left = left + "%"
                    tooltip.style.top = top + "%"
                    tooltip.classList.add("t_l")
                }

                tooltip.style.visibility = 'visible'
                tooltip.style.opacity = 1
            }

            function hideTooltip() {
                tooltip = document.getElementById('tooltip')
                tooltip.classList.remove("t_r")
                tooltip.classList.remove("t_l")
                tooltip.style.visibility = 'hidden'
                tooltip.style.opacity = 0
            }

            d = 80/(plotData.l_c+plotData.r_c);
            h = 65/(plotData.depth);

            iter(treeData, 15, 10+d*plotData.l_c, d, h)
        </script> 
    </body>
    </html> 
    